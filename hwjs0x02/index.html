<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>KSDP JS 0x02 Homework</title>
    <meta name="viewport" content="initial-scale=1,width=device-width" />
    <script language="application/x-template" id="levels">
/*
 * Hello!
 * 这是一个课后的简单作业，改编自 https://github.com/AlexNisnevich/untrusted
 * 红色部分不可修改，黑色部分可以修改
 * `level.setResult` 会将此题标记为传入的参数
 * 若传入参数为`true`则通过
 * 点击下面的“运行”来开始吧！
 *
 * @author Alan-Liang, AlexNisnevich
 */

player.setName(<{> null <}>)
<edit>

var arr = []

</edit>
;level.setResult(arr[2])
|||
//注意体会`this`的作用
level.banWords('level')
var setR = (level.<{> setResult <}>)
// P.S. 记得逗号运算符吗？或者`||`的一种特殊用法？
// P.P.S. 函数表达式是`function name(args) {...}`
setR(false)
|||
<edit>

var res = {
  'result': 'this is useless'
}

</edit>
;level.setResult(res.foo)
|||
//体会prototype的作用
function Foo() {}
<edit>



</edit>
;var bar = new Foo()
level.setResult(bar.baz)
|||
/* const是即将讲到的语法
 * 即setResult这个变量不能更改
 * P.S. 注意体会ASI的作用
 * P.P.S. `&&`的特殊用法还记得吗？
 */

const setResult = level.setResult.bind(level)
<edit>



</edit>
setResult(false)
|||
/*
 * 到这里就结束啦！请截屏发给Alan-Liang
 * 姓名: {{playerName}}
 * 下面还有一道附加题，如果有时间可以试一下
 */
<edit>



</edit>
/* 防止注释破坏 */
level.banWords('level', 'eval', 'Function')
|||
// Good job! 这真的是结束了。
// 您的姓名: {{playerName}}
level.setResult(false)
</script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/codemirror@5.44.0/lib/codemirror.css">
    <link rel="stylesheet" href="./codeeditor.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@material/snackbar@0.44.1/dist/mdc.snackbar.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@material/button@0.44.1/dist/mdc.button.min.css">
    <link rel="stylesheet" href="https://fonts.loli.net/css?family=Source+Code+Pro">
    <style>
    html, head, body {
      margin: 0;
    }
    .mdc-button:disabled {
      color: rgba(255,255,255,.3);
    }
    .CodeMirror {
      font-family: 'Source Code Pro', monospace;
    }
    </style>
  </head>
  <body>
    <textarea id="texts" hidden></textarea>
    <div id="actions">
      <button id="last" class="mdc-button">←上一个</button>
      <button id="run" class="mdc-button mdc-button--raised">▶运行</button>
      <button id="reset" class="mdc-button">重置</button>
      <button id="next" class="mdc-button">下一个→</button>
    </div>
    <div class="mdc-snackbar" id="snackbar">
      <div class="mdc-snackbar__surface">
        <div class="mdc-snackbar__label"
             role="status"
             aria-live="polite">
          Snackbar.
        </div>
        <div class="mdc-snackbar__actions">
          <button type="button" class="mdc-button mdc-snackbar__action">OK</button>
        </div>
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.44.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.44.0/mode/javascript/javascript.js"></script>
    <script src="./codeeditor.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@material/snackbar@0.44.1/dist/mdc.snackbar.min.js"></script>
    <script>
    // code below is generated by babel and uglify
    // DO NOT MODIFY MANUALLY

!function(){var e=function(e){return document.querySelector(e)},t=new CodeEditor("texts"),a=new mdc.snackbar.MDCSnackbar(e("#snackbar")),o=function(e){a.labelText=e,a.open()},n=e("#levels").innerHTML.split("|||"),l=function(){r.disabled=0===c,"passed".concat(c)in localStorage?s.disabled=!1:s.disabled=!0;try{var e=t.getGoodState("level".concat(c));e.endOfStartLevel&&t.setEndOfStartLevel(e.endOfStartLevel),e.editableLines&&t.setEditableLines(e.editableLines),
e.editableSections&&t.setEditableSections(e.editableSections),t.setCode(e.code)}catch(e){t.loadCode(n[c].replace("{{playerName}}",localStorage.name))}},c=0,r=e("#last"),i=e("#run"),d=e("#reset"),s=e("#next");localStorage.current?(c=parseInt(localStorage.current),l()):(t.loadCode(n[0]),localStorage.current=0,r.disabled=!0,s.disabled=!0),t.internalEditor.on("change",function(){return t.saveGoodState("level".concat(c))}),d.onclick=function(){
t.loadCode(n[c].replace("{{playerName}}",localStorage.name))},i.onclick=function(){var e=t.getCode(),a=t.getPlayerCode();try{_eval(e,a)}catch(e){return void o(e)}localStorage["passed".concat(c)]=!0,s.disabled=!1,o("恭喜您，您通过了！点击下一个以继续"),fetch("https://log.keeer.net/",{body:"".concat(localStorage.name," passed level ").concat(c),method:"POST",mode:"cors"})},r.onclick=function(){c--,localStorage.current=c,l()},s.onclick=function(){c++,localStorage.current=c,l()}}()
;var _eval=function _eval(code,playerCode){var ce=void 0,window=ce,document=ce,navigator=ce,history=ce,player={setName:function(e){if(!e)throw"你的名字不是空吧……";localStorage.name=e}},level={setResult:function(e){if(!0!==e)throw"结果不是true…";if("result"in this)throw"不能重复设置结果";this.result=e},banWords:function(){for(var e=arguments,t=0;t<e.length;t++){var a=e[t];if(playerCode.indexOf(a)>-1)throw"您使用了违禁词".concat(a)}}};if(eval(code),!0!==level.result)throw"没有设置结果"};
    </script>
  </body>
</html>
