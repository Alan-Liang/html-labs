"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _possibleConstructorReturn(e,r){return!r||"object"!==_typeof(r)&&"function"!=typeof r?_assertThisInitialized(e):r}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&_setPrototypeOf(e,r)}function _setPrototypeOf(e,r){return(_setPrototypeOf=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e})(e,r)}function _instanceof(e,r){return null!=r&&"undefined"!=typeof Symbol&&r[Symbol.hasInstance]?!!r[Symbol.hasInstance](e):e instanceof r}function _classCallCheck(e,r){if(!_instanceof(e,r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),e}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var magic=_objectSpread({},[0xbeaf4e869c380,0xbeaf4e869c890,0xbeaf4e869cda0,0xbeaf4e869d2b0,0xbeaf4e869d7c0,0xbeaf4e869dcd0,0xbeaf4e869e1e0,0xbeaf4e869e6f0,0xbeaf4e869ec00,0xbeaf4e869f110],{".":0xbeaf4c3ca9140,plus:0xbeaf4eebea240,minus:0xbeaf4e39ce590,times:0xbeaf4fcd65a50,divides:0xbeaf4c33294c2,power:0xbeaf4ef0caeac,paren:0xbeaf4eda250dc,sin:0xbeaf4f93c21c0,cos:0xbeaf4c02f3700,tan:0xbeaf4fc09bdc0,sqrt:0xbeaf4fa0c9590,rparen:0xbeaf4f64c2e3f,ans:0xbeaf4b8e04e00,esyntax:0xbeaf4c7cfc10e,emath:0xbeaf4c72501b4,eoverflow:0xbeaf4c766ec7b,eunderflow:0xbeaf4c7faf9a3,win:0xbeaf507a6b1c0,lose:0xbeaf4e09f41e0}),INT_MAX=1e10,STACK_MAX=10,Char=function(){function e(r,t){_classCallCheck(this,e),this.display=r,this.value=t}return _createClass(e,[{key:"valueOf",value:function(){return this.value}},{key:"name",get:function(){for(var e in magic)if(this.value===magic[e])return e;return null}}]),e}(),Token=function(e){function r(){return _classCallCheck(this,r),_possibleConstructorReturn(this,_getPrototypeOf(r).apply(this,arguments))}return _inherits(r,Char),r}(),NumericalChar=function(e){function r(){return _classCallCheck(this,r),_possibleConstructorReturn(this,_getPrototypeOf(r).apply(this,arguments))}return _inherits(r,Char),r}(),DotChar=function(e){function r(){return _classCallCheck(this,r),_possibleConstructorReturn(this,_getPrototypeOf(r).apply(this,arguments))}return _inherits(r,Char),r}(),OperatorToken=function(e){function r(e,t,n,o){var i;return _classCallCheck(this,r),(i=_possibleConstructorReturn(this,_getPrototypeOf(r).call(this,e,t))).priority=n,i.exec=o,i}return _inherits(r,Token),r}(),FunctionToken=function(e){function r(e,t,n){var o;return _classCallCheck(this,r),(o=_possibleConstructorReturn(this,_getPrototypeOf(r).call(this,e,t))).exec=n,o}return _inherits(r,Token),r}(),ParenToken=function(e){function r(){return _classCallCheck(this,r),_possibleConstructorReturn(this,_getPrototypeOf(r).apply(this,arguments))}return _inherits(r,Token),r}(),SpecialToken=function(e){function r(){return _classCallCheck(this,r),_possibleConstructorReturn(this,_getPrototypeOf(r).apply(this,arguments))}return _inherits(r,Token),r}(),ErrorToken=function(e){function r(){return _classCallCheck(this,r),_possibleConstructorReturn(this,_getPrototypeOf(r).apply(this,arguments))}return _inherits(r,Token),r}(),StateToken=function(e){function r(){return _classCallCheck(this,r),_possibleConstructorReturn(this,_getPrototypeOf(r).apply(this,arguments))}return _inherits(r,Token),r}(),NumberToken=function(e){function r(e){var t;return _classCallCheck(this,r),is(dot,e)&&(t.dotted=!0),t=is(Number,e)?_possibleConstructorReturn(this,_getPrototypeOf(r).call(this,String(e),e)):is(r,e)?_possibleConstructorReturn(this,_getPrototypeOf(r).call(this,e.display,e.value)):_possibleConstructorReturn(this,_getPrototypeOf(r).call(this,e.display,+e.name)),_possibleConstructorReturn(t)}return _inherits(r,Token),_createClass(r,[{key:"append",value:function(e){if(is(dot,e)){if(this.dotted)throw error.esyntax;this.dotted=!0}else{var r=this.dotted&&!String(this.value).includes(".")?".":"";this.value=+(String(this.value)+r+e.name)}}},{key:"display",get:function(){return String(this.value)},set:function(e){this.value=+e}}]),r}(),numeric=_toConsumableArray(Array(10).keys()).map(function(e){return new NumericalChar(String(e),magic[e])}),dot=new DotChar(".",magic["."]),operator={plus:new OperatorToken("+",magic.plus,1,function(e,r){return new NumberToken(e+r)}),minus:new OperatorToken("-",magic.minus,1,function(e,r){return new NumberToken(e-r)}),times:new OperatorToken("×",magic.times,2,function(e,r){return new NumberToken(e*r)}),divides:new OperatorToken("÷",magic.divides,2,function(e,r){return new NumberToken(e/r)}),power:new OperatorToken("^",magic.power,3,function(e,r){return new NumberToken(Math.pow(e,r))})},radFromDeg=2*Math.PI/360,func={paren:new FunctionToken("(",magic.paren,function(e){return e}),sin:new FunctionToken("sin(",magic.sin,function(e){return new NumberToken(Math.sin(e*radFromDeg))}),cos:new FunctionToken("cos(",magic.cos,function(e){return new NumberToken(Math.cos(e*radFromDeg))}),tan:new FunctionToken("tan(",magic.tan,function(e){return new NumberToken(Math.tan(e*radFromDeg))}),sqrt:new FunctionToken("√(",magic.sqrt,function(e){return new NumberToken(Math.sqrt(e))})},rightParen=new ParenToken(")",magic.rparen),special={ans:new SpecialToken("Ans",magic.ans)},error={esyntax:new ErrorToken("Syntax Error",magic.esyntax),emath:new ErrorToken("Math Error",magic.emath),eoverflow:new ErrorToken("Overflow",magic.eoverflow),eunderflow:new ErrorToken("Underflow",magic.eunderflow)},state={win:new StateToken("WIN!!!",magic.win),lose:new StateToken("You Lost The Game.",magic.lose)},staticTokens=_objectSpread({},numeric,{dot:dot},operator,{},func,{rightParen:rightParen},special,{},error,{},state),tokenFromValue=function(e){return e<INT_MAX?new NumberToken(e):Object.values(staticTokens).find(function(r){return+r==+e})},is=function(e,r){return e===Number?"number"==typeof r:e===String?"string"==typeof r:"function"==typeof e?_instanceof(r,e):"number"==typeof e?e===+r:Array.isArray(e)?e.some(function(e){return+e==+r}):_instanceof(e,Char)?+e==+r:Object.values(e).some(function(e){return+e==+r})},tokensFromChars=function(e){var r=[],t=null,n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var u=a.value;is(dot,u)||is(numeric,u)?null===t?t=new NumberToken(u):t.append(u):(null!==t&&(r.push(t),t=null),r.push(u))}}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return null!==t&&r.push(t),r},execOps=function(e){for(;1!==e.length;){var r=e.shift(),t=e.shift(),n=e.shift();if(!is(operator,t))throw error.esyntax;e.unshift(t.exec(r,n))}return e[0]},exec=function e(r){var t=[],n=[],o={priority:-1},i=!0,a=!1,s=void 0;try{for(var u,c=function(){var r=u.value;if(is(func,r))t.push(r),n.push(o),o={priority:-1};else if(is(rightParen,r)){var i=t.reverse().find(function(e){return is(func,e)});t.reverse();var a=t.lastIndexOf(i),s=t.splice(a);if(s.shift(),t.push(i.exec(e(s))),!(o=n.pop()))throw error.esyntax}else if(is(operator,r))if(r.priority>=o.priority)t.push(r),o=r;else{var c=t.reverse().find(function(e){return is(operator,e)&&r.priority>=e.priority});t.reverse();var l=t.lastIndexOf(c),f=t.splice(l+1);console.log("psop",f.map(function(e){return e.display}),t.map(function(e){return e.display}),c),t.push(e(f)),t.push(r),console.log("psop:end",t.map(function(e){return e.display})),o=r}else t.push(r)},l=r[Symbol.iterator]();!(i=(u=l.next()).done);i=!0)c()}catch(e){a=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw s}}if(0!==n.length)throw error.esyntax;var f=Math.min.apply(Math,_toConsumableArray(t.filter(function(e){return is(operator,e)}).map(function(e){return e.priority})));if(o.priority>f){var p=t.findIndex(function(e){return is(operator,e)&&e.priority>f}),h=t.splice(p-1);console.log("plop",h.map(function(e){return e.display})),t.push(e(h))}return console.log("e:end",t.map(function(e){return e.display})),execOps(t)},execChars=function(e){try{var r=exec(tokensFromChars(e));if(is(staticTokens,r))return tokenFromValue(r);if(r>INT_MAX-1)throw error.eoverflow;if(r<-INT_MAX)throw error.eunderflow;if(Number.isNaN(Number(r)))throw error.emath;return tokenFromValue(r)}catch(e){return is(error,e)?tokenFromValue(e):error.esyntax}},lastAns=new NumberToken(0),currentStack=[],cursor=0,isBrowser="undefined"!=typeof window&&window,$=function(e){return isBrowser?document.querySelector(e):{}},displayEl=$("#display"),flushDisplay=function(){var e=[],r=!0,t=!1,n=void 0;try{for(var o,i=currentStack[Symbol.iterator]();!(r=(o=i.next()).done);r=!0){var a=o.value;e.push('<span class="char">'.concat(a.display,"</span>"))}}catch(e){t=!0,n=e}finally{try{r||null==i.return||i.return()}finally{if(t)throw n}}e.splice(cursor,0,'<span class="cursor"></span>'),displayEl.innerHTML=e.join(""),displayEl.className=""},displayAns=function(e){displayEl.innerHTML=e.display||e},left=function(){0!==cursor&&cursor--,flushDisplay()},right=function(){cursor!==currentStack.length&&cursor++,flushDisplay()},del=function(){if(0===cursor)return flushDisplay();currentStack.splice(cursor-1,1),cursor--,flushDisplay()},clearChars=function(){currentStack.length=cursor=0,flushDisplay()},insert=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:cursor;is(Number,e)&&(e=new NumberToken(e)),is(String,e)&&(e=staticTokens[e]),is(Char,e)&&(currentStack.length>=STACK_MAX||(currentStack.splice(r,0,e),cursor++,flushDisplay()))},go=function(){var e=currentStack.map(function(e){return is(special.ans,e)?lastAns:e}),r=execChars(e);return lastAns=r,displayAns(r),currentStack.length=cursor=0,is(state,r)&&(displayEl.className="state"),r},example=function(){var e=23.99,r=Array.from(String(e)).map(function(e){return"."===e?dot:numeric[e]});console.log("e",execChars([func.paren].concat(_toConsumableArray(r),[operator.plus],_toConsumableArray(r),[operator.times,func.sin],_toConsumableArray(r),[operator.power],_toConsumableArray(r),[rightParen,rightParen,operator.times],_toConsumableArray(r),[operator.plus],_toConsumableArray(r))).display),console.log("a",(e+e*Math.sin(radFromDeg*Math.pow(e,e)))*e+e);var t=Array.from("654798816").map(function(e){return"."===e?dot:numeric[e]});console.log("e",execChars([].concat(_toConsumableArray(t),[operator.plus,staticTokens.lose])).display),console.log("a",staticTokens.win.display)};
